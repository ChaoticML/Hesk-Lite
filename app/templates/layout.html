<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}HESK Lite{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <nav>
        <div class="nav-container">
            <!-- Brand link, geen user/password nodig -->
            <a class="nav-brand" href="{{ url_for('main.welcome') }}">HESK Lite</a>
            
            <!-- De hele navigatie sectie moet alleen getoond worden als de gebruiker is ingelogd -->
            {% if g.user %}
            <div class="nav-links">
                <!-- Alle links naar routes binnen de applicatie verwijderen user/password parameters -->
                <a href="{{ url_for('main.index') }}">Actieve Tickets</a>
                <a href="{{ url_for('main.archive') }}">Archief</a>
                <a href="{{ url_for('kb.kb_index') }}">Kennisbank</a>
                <a href="{{ url_for('templates.templates_index') }}">Sjablonen</a>
                <a href="{{ url_for('reports.reports_index') }}">Rapporten</a>
                <a href="{{ url_for('main.create') }}">Nieuw Ticket</a>
            </div>
            <div class="nav-user">
                <!-- Gebruik g.user in plaats van de doorgegeven 'user' variabele -->
                <span>Welkom, {{ g.user }}</span>
                
                <!-- De shutdown link heeft geen user/password parameters nodig -->
                <form action="{{ url_for('main.shutdown') }}" method="get" onsubmit="return confirm('Weet u zeker dat u de applicatie wilt afsluiten?');" style="display: inline-block; margin-left: 1em;">
                    <button type="submit" class="shutdown-button">Afsluiten</button>
                </form>
                
                <!-- Voeg hier een logout knop toe voor een betere UX -->
                <a href="{{ url_for('auth.logout') }}" class="logout-button">Uitloggen</a>

            </div>
            {% endif %}
        </div>
    </nav>
    
    <main class="content">
        <!-- Flash berichten worden beheerd door Flask en zijn al correct weergegeven -->
        <div class="flash-messages">
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        <div class="flash {{ category }}">
                            <span>{{ message }}</span>
                            <button class="flash-close" onclick="this.parentElement.style.display='none';">Ã—</button>
                        </div>
                    {% endfor %}
                {% endif %}
            {% endwith %}
        </div>
        
        {% block content %}{% endblock %}
    </main>
</body>
</html>