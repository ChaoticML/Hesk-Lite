{% extends 'layout.html' %}
{% block title %}Actieve Tickets{% endblock %}
{% block content %}
    <h1>Actieve Tickets</h1>

    <!-- ZOEKBALK -->
    <div class="search-container">
        <form method="get" action="{{ url_for('main.index') }}">
            <input type="hidden" name="user" value="{{ user }}">
            <input type="hidden" name="password" value="{{ password }}">
            <input type="search" name="search" placeholder="Zoek in tickets..." value="{{ search_query or '' }}">
            <button type="submit">Zoek</button>
        </form>
    </div>
    <!-- TICKETLIJST -->
    {% for ticket in tickets %}
        <div class="ticket-summary">
            <h3><a href="{{ url_for('main.view_ticket', ticket_id=ticket.id, user=user, password=password) }}">{{ ticket.title }}</a></h3>
            <p>
                <strong>Status:</strong> {{ ticket.status }} |
                <strong>Prioriteit:</strong> {{ ticket.priority }} |
                <strong>Aanvrager:</strong> {{ ticket.requester_name }} |
                <strong>Toegewezen aan:</strong> {% if ticket.assigned_to %}{{ ticket.assigned_to }}{% else %}Niemand{% endif %}
            </p>
        </div>
    {% else %}
        {% if search_query %}
            <p>Geen tickets gevonden die overeenkomen met uw zoekopdracht.</p>
        {% else %}
            <p>Geen actieve tickets gevonden. Goed werk! <a href="{{ url_for('main.create', user=user, password=password) }}">Maak de eerste aan!</a></p>
        {% endif %}
    {% endfor %}
{% endblock %}