{% extends 'layout.html' %}
{% block title %}Archief{% endblock %}
{% block content %}
    <h1>Archief</h1>
    
    <div class="filter-container">
        <form method="get" action="{{ url_for('main.archive') }}">
            <input type="hidden" name="user" value="{{ user }}">
            <input type="hidden" name="password" value="{{ password }}">
            
            <div class="form-group">
                <label for="search">Zoek:</label>
                <input type="search" id="search" name="search" placeholder="Zoek in archief..." value="{{ search_query or '' }}">
            </div>

            <div class="form-group">
                <label for="sort">Sorteer op:</label>
                <select id="sort" name="sort">
                    <option value="created_at_desc" {% if sort_by == 'created_at_desc' %}selected{% endif %}>Datum (Nieuwste eerst)</option>
                    <option value="created_at_asc" {% if sort_by == 'created_at_asc' %}selected{% endif %}>Datum (Oudste eerst)</option>
                    <option value="priority" {% if sort_by == 'priority' %}selected{% endif %}>Prioriteit (Hoog > Laag)</option>
                </select>
            </div>
            
            <button type="submit" class="filter-button">Toepassen</button>
        </form>
    </div>

    {% for ticket in tickets %}
        <div class="ticket-summary priority-{{ ticket.priority.lower() }}">
            <h3><a href="{{ url_for('main.view_ticket', ticket_id=ticket.id, user=user, password=password) }}">{{ ticket.title }}</a></h3>
            <p>
                <strong>Aangemaakt:</strong> {{ ticket.created_at | datetimeformat }} |
                <strong>Status:</strong> {{ ticket.status }} |
                <strong>Prioriteit:</strong> {{ ticket.priority }} |
                <strong>Aanvrager:</strong> {{ ticket.requester_name }} |
                <strong>Toegewezen aan:</strong> {% if ticket.assigned_to %}{{ ticket.assigned_to }}{% else %}Niemand{% endif %}
            </p>
        </div>
    {% else %}
        <p>Geen gearchiveerde tickets gevonden die aan de criteria voldoen.</p>
    {% endfor %}
{% endblock %}